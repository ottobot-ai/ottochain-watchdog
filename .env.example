# ===========================================
# OttoChain Watchdog Configuration
# ===========================================
# Copy to .env and fill in your values

# ----- Node Configuration -----
# Comma-separated list of metagraph node IPs
NODE_IPS=10.0.0.1,10.0.0.2,10.0.0.3
NODE_NAMES=node1,node2,node3

# SSH access for restart commands
SSH_KEY_PATH=/root/.ssh/hetzner_ottobot
SSH_USER=root

# ----- Data Sources -----
# Redis URL (for reading cached health from services monitor)
# If not configured, watchdog uses direct HTTP polling only
REDIS_URL=redis://localhost:6379

# Postgres URL (for reading/writing events)
# If not configured, event publishing is disabled
DATABASE_URL=postgresql://ottochain:ottochain-local-dev@localhost:5432/ottochain

# Seconds before health data from Redis is considered stale
# When stale, watchdog falls back to direct HTTP polling
HEALTH_DATA_STALE_SECONDS=60

# ----- Thresholds -----
# Minutes of no ML0 ordinal change before triggering restart
SNAPSHOT_STALL_MINUTES=4

# Seconds between health checks
HEALTH_CHECK_INTERVAL=60

# Minutes to wait after a restart before allowing another
RESTART_COOLDOWN_MINUTES=10

# Maximum restarts allowed per hour (prevents restart loops)
MAX_RESTARTS_PER_HOUR=6

# ----- Layer Ports -----
# Public API ports for each layer
GL0_PORT=9000
ML0_PORT=9200
CL1_PORT=9300
DL1_PORT=9400

# CLI ports (for cluster join commands)
GL0_CLI_PORT=9002
ML0_CLI_PORT=9202
CL1_CLI_PORT=9302
DL1_CLI_PORT=9402

# P2P ports
GL0_P2P_PORT=9001
ML0_P2P_PORT=9201
CL1_P2P_PORT=9301
DL1_P2P_PORT=9401
